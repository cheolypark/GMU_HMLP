SELECT 
DISTINCT

/* for target 1 at at time 1 and 2 */

tp_g1_t2.t as 'time_g1_t2',
tp_g1_t2.Latitude as 'Latitude_g1_t2',
tp_g1_t2.Longitude as 'Longitude_g1_t2',
tp_g1_t2.Altitude as 'Altitude_g1_t2',
tp_g1_t2.Latitude_Velocity as 'Latitude_Velocity_g1_t2',
tp_g1_t2.Longitude_Velocity as 'Longitude_Velocity_g1_t2',
tp_g1_t2.Altitude_Velocity as 'Altitude_Velocity_g1_t2',
tp_g1_t2.DistanceToCI as 'DistanceToCI_g1_t2',
tp_g1_t2.DirectionToCI as 'DirectionToCI_g1_t2',
tp_g1_t2.RegionType as 'RegionType_g1_t2',
tp_g1_t2.Temperature as 'Temperature_g1_t2',
tp_g1_t2.Activity as 'Activity_g1_t2',
tp_g1_t2.Mission as 'Mission_g1_t2',

tp_g1_t1.t as 'time_g1_t1',
tp_g1_t1.Latitude as 'Latitude_g1_t1',
tp_g1_t1.Longitude as 'Longitude_g1_t1',
tp_g1_t1.Altitude as 'Altitude_g1_t1',
tp_g1_t1.Latitude_Velocity as 'Latitude_Velocity_g1_t1',
tp_g1_t1.Longitude_Velocity as 'Longitude_Velocity_g1_t1',
tp_g1_t1.Altitude_Velocity as 'Altitude_Velocity_g1_t1',
tp_g1_t1.DistanceToCI as 'DistanceToCI_g1_t1',
tp_g1_t1.DirectionToCI as 'DirectionToCI_g1_t1',
tp_g1_t1.RegionType as 'RegionType_g1_t1',
tp_g1_t1.Temperature as 'Temperature_g1_t1',
tp_g1_t1.Activity as 'Activity_g1_t1',
tp_g1_t1.Mission as 'Mission_g1_t1',

tg_g1.TargetType as 'TargetType_g1',
tg_g1.TargetSize as 'TargetSize_g1',
tg_g1.TargetImage as 'TargetImage_g1',
 
/* for target 2 at at time 1 and 2 */

tp_g2_t2.t as 'time_g2_t2',
tp_g2_t2.Latitude as 'Latitude_g2_t2',
tp_g2_t2.Longitude as 'Longitude_g2_t2',
tp_g2_t2.Altitude as 'Altitude_g2_t2',
tp_g2_t2.Latitude_Velocity as 'Latitude_Velocity_g2_t2',
tp_g2_t2.Longitude_Velocity as 'Longitude_Velocity_g2_t2',
tp_g2_t2.Altitude_Velocity as 'Altitude_Velocity_g2_t2',
tp_g2_t2.DistanceToCI as 'DistanceToCI_g2_t2',
tp_g2_t2.DirectionToCI as 'DirectionToCI_g2_t2',
tp_g2_t2.RegionType as 'RegionType_g2_t2',
tp_g2_t2.Temperature as 'Temperature_g2_t2',
tp_g2_t2.Activity as 'Activity_g2_t2',
tp_g2_t2.Mission as 'Mission_g2_t2',

tp_g2_t1.t as 'time_g2_t1',
tp_g2_t1.Latitude as 'Latitude_g2_t1',
tp_g2_t1.Longitude as 'Longitude_g2_t1',
tp_g2_t1.Altitude as 'Altitude_g2_t1',
tp_g2_t1.Latitude_Velocity as 'Latitude_Velocity_g2_t1',
tp_g2_t1.Longitude_Velocity as 'Longitude_Velocity_g2_t1',
tp_g2_t1.Altitude_Velocity as 'Altitude_Velocity_g2_t1',
tp_g2_t1.DistanceToCI as 'DistanceToCI_g2_t1',
tp_g2_t1.DirectionToCI as 'DirectionToCI_g2_t1',
tp_g2_t1.RegionType as 'RegionType_g2_t1',
tp_g2_t1.Temperature as 'Temperature_g2_t1',
tp_g2_t1.Activity as 'Activity_g2_t1',
tp_g2_t1.Mission as 'Mission_g2_t1',

tg_g2.TargetType as 'TargetType_g2',
tg_g2.TargetSize as 'TargetSize_g2',
tg_g2.TargetImage as 'TargetImage_g2',

/* for dangerlevel 2 at at time 2 */

cit_t1.DangerLevel as 'DangerLevel_ci1'

FROM 
/* for target 1 at at time 1 and 2 */
TargetTemporalProperty as tp_g1_t1 
join TargetTemporalProperty as tp_g1_t2 
join predecessor as pd_g1_t1  
join Target as tg_g1 
join mti_report as mr_g1_t1  
join reportedtarget_mtirpt as rm_g1_t1  
join sensortemporalproperty as st_g1_t1  
join IMINTS_report as ir_g1_t1  
join reportedtarget_IMINTSrpt as ri_g1_t1  
join geoints_report as gr_g1_t1  
join reportedtarget_geointsrpt as rg_g1_t1  
   
/* for target 2 at at time 1 and 2 */ 
join TargetTemporalProperty as tp_g2_t1 
join TargetTemporalProperty as tp_g2_t2 
join predecessor as pd_g2_t1  
join Target as tg_g2 
join mti_report as mr_g2_t1  
join reportedtarget_mtirpt as rm_g2_t1  
join sensortemporalproperty as st_g2_t1  
join IMINTS_report as ir_g2_t1  
join reportedtarget_IMINTSrpt as ri_g2_t1  
join geoints_report as gr_g2_t1  
join reportedtarget_geointsrpt as rg_g2_t1  
    
/* for situation at at time 2 */
join ci_situation as cit_t1 

/* for target 1 at at time 1 and 2 */
on tp_g1_t2.t = pd_g1_t1.t and tp_g1_t1.t = pd_g1_t1.pret 
and tp_g1_t2.tr = tg_g1.tr and tp_g1_t1.tr = tg_g1.tr 
and tp_g1_t2.tr = st_g1_t1.tr and tp_g1_t2.t = st_g1_t1.t 
and tp_g1_t2.t = mr_g1_t1.t and rm_g1_t1.mtireportedtargetid = mr_g1_t1.rt_mti 
and rm_g1_t1.actualtarget_mtirpt = tp_g1_t2.tr and tp_g1_t2.t = ir_g1_t1.t 
and ri_g1_t1.IMINTSreportedtargetid = ir_g1_t1.rt_IMINTS 
and ri_g1_t1.actualtarget_IMINTSrpt = tp_g1_t2.tr and tp_g1_t2.t = gr_g1_t1.t 
and rg_g1_t1.geointsreportedtargetid = gr_g1_t1.rt_geoints 
and rg_g1_t1.actualtarget_geointsrpt = tp_g1_t2.tr 
  
/* for target 2 at at time 1 and 2 */ 
and tp_g2_t2.t = pd_g2_t1.t and tp_g2_t1.t = pd_g2_t1.pret 
and tp_g2_t2.tr = tg_g2.tr and tp_g2_t1.tr = tg_g2.tr 
and tp_g2_t2.tr = st_g2_t1.tr and tp_g2_t2.t = st_g2_t1.t 
and tp_g2_t2.t = mr_g2_t1.t and rm_g2_t1.mtireportedtargetid = mr_g2_t1.rt_mti 
and rm_g2_t1.actualtarget_mtirpt = tp_g2_t2.tr and tp_g2_t2.t = ir_g2_t1.t 
and ri_g2_t1.IMINTSreportedtargetid = ir_g2_t1.rt_IMINTS 
and ri_g2_t1.actualtarget_IMINTSrpt = tp_g2_t2.tr and tp_g2_t2.t = gr_g2_t1.t 
and rg_g2_t1.geointsreportedtargetid = gr_g2_t1.rt_geoints 
and rg_g2_t1.actualtarget_geointsrpt = tp_g2_t2.tr

/* for conneting two targets*/ 
and tp_g1_t2.t = tp_g2_t2.t

/* for siuation at time 1*/
and cit_t1.t = tp_g2_t2.t



